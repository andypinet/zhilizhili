{"version":3,"names":[],"mappings":"","sources":["about/my_class/contents.js"],"sourcesContent":["export default function() {\n\t\tfunction contents() {\n\t\t\tthis.shareSite = bind(this.shareSite, this);\n\t\t\tthis.shareSns = bind(this.shareSns, this);\n\t\t\tthis._makePageElm = bind(this._makePageElm, this);\n\t\t\tthis.disposePage = bind(this.disposePage, this);\n\t\t\tthis.showMovie = bind(this.showMovie, this);\n\t\t\tthis.showHelp = bind(this.showHelp, this);\n\t\t\tthis.showSystem = bind(this.showSystem, this);\n\t\t\tthis._scrollOff = bind(this._scrollOff, this);\n\t\t\tthis._disposeRecord = bind(this._disposeRecord, this);\n\t\t\tthis._makeRecord = bind(this._makeRecord, this);\n\t\t\tthis._makeFooter = bind(this._makeFooter, this);\n\t\t\tthis.retry = bind(this.retry, this);\n\t\t\tthis._eGameOver = bind(this._eGameOver, this);\n\t\t\tthis._eGetItem = bind(this._eGetItem, this);\n\t\t\tthis._eHidedLoading = bind(this._eHidedLoading, this);\n\t\t\tthis._eStartGame = bind(this._eStartGame, this);\n\t\t\tthis._eReadyAll = bind(this._eReadyAll, this);\n\t\t\tthis._eCompleteFirstStgBgm = bind(this._eCompleteFirstStgBgm, this);\n\t\t\tthis._eCompleteCmnSe = bind(this._eCompleteCmnSe, this);\n\t\t\tthis._eProgressCmnSound = bind(this._eProgressCmnSound, this);\n\t\t\tthis._eCompleteFirstStageData = bind(this._eCompleteFirstStageData, this);\n\t\t\tthis._eProgressFirstStageData = bind(this._eProgressFirstStageData, this);\n\t\t\tthis._eMakedData = bind(this._eMakedData, this);\n\t\t\tthis._eProgressData = bind(this._eProgressData, this);\n\t\t\tthis._eCompleteParam = bind(this._eCompleteParam, this);\n\t\t\tthis.start = bind(this.start, this);\n\t\t\tthis._audioMgr;\n\t\t\tthis._parameter;\n\t\t\tthis._interaction;\n\t\t\tthis._gl;\n\t\t\tthis._checker;\n\t\t\tthis._data;\n\t\t\tthis._game;\n\t\t\tthis._bg;\n\t\t\tthis._footer;\n\t\t\tthis._record;\n\t\t\tthis._ui;\n\t\t\tthis._page;\n\t\t\tthis._loading;\n\t\t\tthis._restart;\n\t\t\tthis._conf = root.MY.app.conf;\n\t\t}\n\n\t\tcontents.prototype.start = function() {\n\t\t\tvar sorry;\n\t\t\troot.MY.gl.contents = this;\n\t\t\t// 检测是否有webgl支持\n\t\t\tif (!Modernizr.webgl || !Detector.webgl) {\n\t\t\t\tsorry = new root.MY_CLASS.sorryView(this._makePageElm());\n\t\t\t\tsorry.setup();\n\t\t\t\treturn;\n\t\t\t}\t\t\t\t\t\t\n\t\t\t//window.FB.init({\n\t\t\t//\tappId: root.MY.app.conf.FB_APP_ID,\n\t\t\t//\tapiKey: root.MY.app.conf.FB_APP_ID,\n\t\t\t//\tstatus: true,\n\t\t\t//\tcookie: true,\n\t\t\t//\txfbml: true\n\t\t\t//});\n\t\t\tthis._scrollOff();\n\t\t\tif (!this._conf.RELEASE && location.pathname.indexOf(\"checker.html\") !== -1) {\n\t\t\t\tthis._checker = new root.MY_CLASS.checkerMain();\n\t\t\t\tthis._checker.start();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this._conf.RELEASE && location.pathname.indexOf(\"road.html\") !== -1) {\n\t\t\t\tthis._checker = new root.MY_CLASS.checkRoad();\n\t\t\t\tthis._checker.start();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!root.MY.myfw.conf.IS_SMT) {\n\t\t\t\tthis._restart = new root.MY_CLASS.restartView($(\"#restart\"));\n\t\t\t\tthis._restart.setup();\n\t\t\t}\n\t\t\t// this._interaction = new root.MY_CLASS.interaction();\n\t\t\t// this._interaction.start();\n\t\t\t// root.MY.gl.interaction = this._interaction;\n\t\t\t// this._loading = new root.MY_CLASS.loadingView($(\"#loading\"));\n\t\t\t// this._loading.onHided = this._eHidedLoading;\n\t\t\t// this._loading.setup();\n\t\t\tthis._makeFooter();\n\t\t\tthis._makeRecord();\n\t\t\tthis._parameter = new root.MY_CLASS.parameter();\n\t\t\tthis._parameter.onComplete = this._eCompleteParam;\n\t\t\troot.MY.gl.parameter = this._parameter;\n\t\t\treturn this._parameter.start();\n\t\t};\n\n\t\tcontents.prototype._eCompleteParam = function() {\n\t\t\tthis._data = new root.MY_CLASS.data();\n\t\t\troot.MY.gl.data = this._data;\n\t\t\tthis._data.onProgress = this._eProgressData;\n\t\t\tthis._data.onComplete = this._eMakedData;\n\t\t\treturn this._data.start();\n\t\t};\n\n\t\tcontents.prototype._eProgressData = function(rate) {\n\t\t\t// return this._loading.setLoading(rate, 0);\n\t\t};\n\n\t\tcontents.prototype._eMakedData = function() {\n\t\t\tthis._ui = new root.MY_CLASS.gameUiView($(\"#gameUi\"));\n\t\t\t// this._ui.setup();\n\t\t\troot.MY.gl.ui = this._ui;\n\t\t\tthis._game = new root.MY_CLASS.game();\n\t\t\tthis._game.onGameOver = this._eGameOver;\n\t\t\tthis._game.start();\n\t\t\troot.MY.gl.game = this._game;\n\t\t\tif (root.MY.app.conf.SOUND_SWF) {\n\t\t\t\tthis._audioMgr = new root.MY_CLASS.audioSwfMgr();\n\t\t\t} else {\n\t\t\t\tthis._audioMgr = new root.MY_CLASS.audioMgr();\n\t\t\t}\n\t\t\tthis._audioMgr.start();\n\t\t\troot.MY.gl.audio = this._audioMgr;\n\t\t\tthis._gl = new root.MY_CLASS.webglMain();\n\t\t\tthis._gl.onGetItem = this._eGetItem;\n\t\t\tthis._gl.onStart = this._eStartGame;\n\t\t\tthis._gl.start();\n\t\t\t// this._gl.makeRoad();\n\t\t\troot.MY.gl.main = this._gl;\n\t\t\tthis._data.onProgressNextData = this._eProgressFirstStageData;\n\t\t\tthis._data.onCompleteNextData = this._eCompleteFirstStageData;\n\t\t\treturn this._data.loadNextStage(root.MY.app.conf.STAGE_ORDER[0], 0, false);\n\t\t};\n\n\t\tcontents.prototype._eProgressFirstStageData = function(rate) {\n\t\t\t// if (this._loading != null) {\n\t\t\t// \treturn this._loading.setLoading(rate, 1);\n\t\t\t// }\n\t\t};\n\n\t\tcontents.prototype._eCompleteFirstStageData = function() {\n\t\t\tthis._audioMgr.onProgressCmnSound = this._eProgressCmnSound;\n\t\t\tthis._audioMgr.onCompleteCmnSe = this._eCompleteCmnSe;\n\t\t\treturn this._audioMgr.loadCmnSe();\n\t\t};\n\n\t\tcontents.prototype._eProgressCmnSound = function(rate) {\n\t\t\t// return this._loading.setLoading(rate, 2);\n\t\t};\n\n\t\tcontents.prototype._eCompleteCmnSe = function() {\n\t\t\tthis._audioMgr.onCompleteStageBgm = this._eCompleteFirstStgBgm;\n\t\t\treturn this._audioMgr.loadStgBgm(this._game.stageId());\n\t\t};\n\n\t\tcontents.prototype._eCompleteFirstStgBgm = function() {\n\t\t\t// this._loading.setLoading(1, 3);\n\t\t\tthis._gl.isPostEffect(true);\n\t\t\tthis._bg = new root.MY_CLASS.bgView($(\"#bg\"));\n\t\t\tthis._bg.setup();\n\t\t\troot.MY.gl.bg = this._bg;\n\t\t\tthis._gl.makeTop();\n\t\t\treturn this._eReadyAll();\n\t\t};\n\n\t\tcontents.prototype._eReadyAll = function() {\n\t\t\t// this._loading.hide();\n\t\t\treturn this._gl.startBrightAnimation(160, 170, \"easeOutExpo\", 1);\n\t\t};\n\n\t\tcontents.prototype._eStartGame = function() {\n\t\t\tthis._disposeRecord();\n\t\t\troot.MY.gl.bg.hide();\n\t\t\troot.MY.gl.footer.hide();\n\t\t\tthis._audioMgr.playStgBgm(this._game.stageId());\n\t\t\tthis._gl.startGame();\n\t\t\tthis._ui.show();\n\t\t\tthis._ui.setMouseTg();\n\t\t\treturn this._game.startGame();\n\t\t};\n\n\t\tcontents.prototype._eHidedLoading = function() {\n\t\t\t// if (this._loading != null) {\n\t\t\t// \tthis._loading.dispose();\n\t\t\t// \treturn this._loading = null;\n\t\t\t// }\n\t\t};\n\n\t\tcontents.prototype._eGetItem = function(rank, combo) {\n\t\t\tthis._game.upLife(rank, combo);\n\t\t\tthis._audioMgr.playItemGetSe(combo);\n\t\t\treturn this._ui.life().upLifeAnimation();\n\t\t};\n\n\t\tcontents.prototype._eGameOver = function() {\n\t\t\tthis._ui.showResult(this._game.point(), this._game.clearType());\n\t\t\tthis._gl.stopGame();\n\t\t\tif (!root.MY.myfw.conf.IS_SMT) {\n\t\t\t\treturn this._gl.startBrightAnimation(100, 10, \"easeOutExpo\", 0, -0.1, false);\n\t\t\t}\n\t\t};\n\n\t\tcontents.prototype.retry = function() {\n\t\t\troot.MY.gl.bg.hide();\n\t\t\troot.MY.gl.footer.hide();\n\t\t\tthis._game.resetGame();\n\t\t\tthis._ui.reset();\n\t\t\tthis._gl.resetGame();\n\t\t\tthis._audioMgr.playStgBgm(this._game.stageId());\n\t\t\tthis._gl.startGame();\n\t\t\treturn this._game.startGame();\n\t\t};\n\n\t\tcontents.prototype._makeFooter = function() {\n\t\t\tthis._footer = new root.MY_CLASS.footerView($(\"#footer\"));\n\t\t\tthis._footer.setup();\n\t\t\treturn root.MY.gl.footer = this._footer;\n\t\t};\n\n\t\tcontents.prototype._makeRecord = function() {\n\t\t\tthis._record = new root.MY_CLASS.recordView($(\"#record\"));\n\t\t\t// this._record.setup();\n\t\t\treturn root.MY.gl.record = this._record;\n\t\t};\n\n\t\tcontents.prototype._disposeRecord = function() {\n\t\t\tif (this._record != null) {\n\t\t\t\tthis._record.dispose();\n\t\t\t\tthis._record = null;\n\t\t\t\treturn root.MY.gl.record = null;\n\t\t\t}\n\t\t};\n\n\t\tcontents.prototype._scrollOff = function() {\n\t\t\tif (root.MY.myfw.conf.IS_SMT) {\n\t\t\t\treturn $(window).on('touchmove.noScroll', (function(_this) {\n\t\t\t\t\treturn function(e) {\n\t\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t\t};\n\t\t\t\t})(this));\n\t\t\t} else {\n\t\t\t\t$(\"body,html\").css({\n\t\t\t\t\toverflow: \"hidden\",\n\t\t\t\t\theight: \"100%\"\n\t\t\t\t});\n\t\t\t\treturn $(window).mousewheel((function(_this) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\tif ((typeof event !== \"undefined\" && event !== null) && (event.preventDefault != null)) {\n\t\t\t\t\t\t\treturn event.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t})(this));\n\t\t\t}\n\t\t};\n\n\t\tcontents.prototype.showSystem = function() {\n\t\t\tthis.disposePage();\n\t\t\tthis._page = new root.MY_CLASS.systemView(this._makePageElm());\n\t\t\treturn this._page.setup();\n\t\t};\n\n\t\tcontents.prototype.showHelp = function() {\n\t\t\tthis.disposePage();\n\t\t\tthis._page = new root.MY_CLASS.helpView(this._makePageElm());\n\t\t\treturn this._page.setup();\n\t\t};\n\n\t\tcontents.prototype.showMovie = function() {\n\t\t\tthis.disposePage();\n\t\t\tthis._page = new root.MY_CLASS.movieView(this._makePageElm());\n\t\t\treturn this._page.setup();\n\t\t};\n\n\t\tcontents.prototype.disposePage = function() {\n\t\t\tif (this._page != null) {\n\t\t\t\tthis._page.dispose();\n\t\t\t\treturn this._page = null;\n\t\t\t}\n\t\t};\n\n\t\tcontents.prototype._makePageElm = function() {\n\t\t\tif ($(\"#page\").length > 0) {\n\t\t\t\treturn $(\"#page\");\n\t\t\t}\n\t\t\t$(\"body\").append(\"<div id='page'></div>\");\n\t\t\treturn $(\"#page\");\n\t\t};\n\n\t\tcontents.prototype.shareSns = function(type) {\n\t\t\tvar text, url;\n\t\t\tswitch (type) {\n\t\t\t\tcase this._conf.SNS_TW:\n\t\t\t\t\ttext = this._conf.RESULT_SHARE_TEXT_TW.replace(\"<url>\", this._conf.THIS_SITE);\n\t\t\t\t\ttext = text.replace(\"<point>\", root.MY.gl.game.point());\n\t\t\t\t\turl = this._conf.RESULT_SHARE_TW.replace(\"<text>\", encodeURIComponent(text));\n\t\t\t\t\treturn window.open(url, \"\");\n\t\t\t\tcase this._conf.SNS_FB:\n\t\t\t\t\ttext = this._conf.RESULT_SHARE_TEXT_FB.replace(\"<point>\", root.MY.gl.game.point());\n\t\t\t\t\t//return window.FB.ui({\n\t\t\t\t\t//\tmethod: 'feed',\n\t\t\t\t\t//\tlink: this._conf.THIS_SITE,\n\t\t\t\t\t//\tcaption: text\n\t\t\t\t\t//}, (function(_this) {\n\t\t\t\t\t//\treturn function(e) {};\n\t\t\t\t\t//})(this));\n\t\t\t\tcase this._conf.SNS_LINE:\n\t\t\t\t\ttext = this._conf.RESULT_SHARE_TEXT_LINE.replace(\"<url>\", this._conf.THIS_SITE);\n\t\t\t\t\ttext = text.replace(\"<point>\", root.MY.gl.game.point());\n\t\t\t\t\turl = this._conf.RESULT_SHARE_LINE.replace(\"<text>\", encodeURIComponent(text));\n\t\t\t\t\treturn window.open(url, \"\");\n\t\t\t}\n\t\t};\n\n\t\tcontents.prototype.shareSite = function(type) {\n\t\t\tvar text, url;\n\t\t\tswitch (type) {\n\t\t\t\tcase this._conf.SNS_TW:\n\t\t\t\t\ttext = this._conf.SITE_SHARE_TEXT_TW.replace(\"<url>\", this._conf.THIS_SITE);\n\t\t\t\t\turl = this._conf.SITE_SHARE_TW.replace(\"<text>\", encodeURIComponent(text));\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._conf.SNS_FB:\n\t\t\t\t\turl = this._conf.SITE_SHARE_FB.replace(\"<url>\", this._conf.THIS_SITE);\n\t\t\t}\n\t\t\treturn window.open(url, \"\");\n\t\t};\n\n\t\treturn contents;\n\n\t}"],"file":"about/my_class/contents.js","sourceRoot":"/source/"}