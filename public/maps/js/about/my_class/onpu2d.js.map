{"version":3,"names":[],"mappings":"","sources":["about/my_class/onpu2d.js"],"sourcesContent":["export default function(superClass) {\n\t\textend(onpu2d, superClass);\n\n\t\tfunction onpu2d(parent, key) {\n\t\t\tthis.hide = bind(this.hide, this);\n\t\t\tthis._startEffect = bind(this._startEffect, this);\n\t\t\tthis._makeEffect = bind(this._makeEffect, this);\n\t\t\tthis._isContainMouse = bind(this._isContainMouse, this);\n\t\t\tthis.show = bind(this.show, this);\n\t\t\tthis.getOnpuSize = bind(this.getOnpuSize, this);\n\t\t\tthis._setTransform = bind(this._setTransform, this);\n\t\t\tthis._eCompleteOnpu = bind(this._eCompleteOnpu, this);\n\t\t\tthis.setBasePos = bind(this.setBasePos, this);\n\t\t\tthis._updateOnpu = bind(this._updateOnpu, this);\n\t\t\tthis._updateEffect = bind(this._updateEffect, this);\n\t\t\tthis.update = bind(this.update, this);\n\t\t\tthis.dispose2 = bind(this.dispose2, this);\n\t\t\tthis.addStage = bind(this.addStage, this);\n\t\t\tonpu2d.__super__.constructor.call(this, {\n\t\t\t\tupdate: true\n\t\t\t});\n\t\t\tthis._parent = parent;\n\t\t\tthis._key = key;\n\t\t\tthis._param = {\n\t\t\t\tbaseScale: 1,\n\t\t\t\tbaseX: 0,\n\t\t\t\tbaseY: 0,\n\t\t\t\tonpuX: 0,\n\t\t\t\tonpuY: 0,\n\t\t\t\tonpuVX: 0,\n\t\t\t\tonpuVY: 0,\n\t\t\t\tonpuOffsetX: 0,\n\t\t\t\tonpuOffsetY: 0,\n\t\t\t\tonpuTgOffsetX: 0,\n\t\t\t\tonpuTgOffsetY: 0,\n\t\t\t\tonpuRot: 0\n\t\t\t};\n\t\t\tthis._anm;\n\t\t\tthis._onpuImg;\n\t\t\tthis._isSmt = root.MY.myfw.conf.IS_SMT;\n\t\t\tthis._effect = [];\n\t\t\tthis._floater;\n\t\t\tthis._interaction;\n\t\t\tthis._isEffect = false;\n\t\t\tthis._isHide = false;\n\t\t}\n\n\t\tonpu2d.prototype.addStage = function() {\n\t\t\tvar start;\n\t\t\tthis._interaction = root.MY.gl.interaction;\n\t\t\tthis._makeEffect();\n\t\t\tthis._onpuImg = new root._LIBS.displayImage(root.MY.app.conf.PATH_IMG.LOADING + \"onpu\" + this._key + \".png\", root.MY.app.conf.IMG_RETINA);\n\t\t\tthis._onpuImg.onLoad = this._eCompleteOnpu;\n\t\t\tthis.addChild(this._onpuImg);\n\t\t\tstart = this._key * 40;\n\t\t\tthis._floater = new root._LIBS.float(this._param, [\n\t\t\t\t{\n\t\t\t\t\ttarget: \"onpuX\",\n\t\t\t\t\trange: 4,\n\t\t\t\t\tspeed: 1,\n\t\t\t\t\tstart: start\n\t\t\t\t}, {\n\t\t\t\t\ttarget: \"onpuY\",\n\t\t\t\t\trange: 20,\n\t\t\t\t\tspeed: 2,\n\t\t\t\t\tstart: start\n\t\t\t\t}, {\n\t\t\t\t\ttarget: \"onpuRot\",\n\t\t\t\t\trange: 16,\n\t\t\t\t\tspeed: 2,\n\t\t\t\t\tstart: start\n\t\t\t\t}\n\t\t\t]);\n\t\t\tthis._anm = new root._LIBS.animation();\n\t\t\treturn this.visible(false);\n\t\t};\n\n\t\tonpu2d.prototype.dispose2 = function() {\n\t\t\tvar i, j, len1, ref, val;\n\t\t\tif (this._anm != null) {\n\t\t\t\tthis._anm.dispose();\n\t\t\t\tthis._anm = null;\n\t\t\t}\n\t\t\tif (this._onpuImg != null) {\n\t\t\t\tthis._onpuImg.dispose();\n\t\t\t\tthis._onpuImg = null;\n\t\t\t}\n\t\t\tif (this._effect != null) {\n\t\t\t\tref = this._effect;\n\t\t\t\tfor (i = j = 0, len1 = ref.length; j < len1; i = ++j) {\n\t\t\t\t\tval = ref[i];\n\t\t\t\t\tval.tg.dispose();\n\t\t\t\t\tval.anm.dispose();\n\t\t\t\t\tthis._effect[i] = null;\n\t\t\t\t}\n\t\t\t\tthis._effect = null;\n\t\t\t}\n\t\t\tif (this._floater != null) {\n\t\t\t\tthis._floater.dispose();\n\t\t\t\tthis._floater = null;\n\t\t\t}\n\t\t\tthis._parent = null;\n\t\t\tthis._param = null;\n\t\t\treturn this._interaction = null;\n\t\t};\n\n\t\tonpu2d.prototype.update = function() {\n\t\t\tthis._floater.update();\n\t\t\tif (this._isSmt) {\n\t\t\t\tif (!this._isEffect && this._isContainMouse()) {\n\t\t\t\t\tthis._startEffect();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._updateEffect();\n\t\t\tthis._updateOnpu();\n\t\t\treturn this._setTransform();\n\t\t};\n\n\t\tonpu2d.prototype._updateEffect = function() {\n\t\t\tvar anm, cnt, i, j, len1, ref, s, tg, val;\n\t\t\tif (this._isEffect) {\n\t\t\t\tcnt = 0;\n\t\t\t\tref = this._effect;\n\t\t\t\tfor (i = j = 0, len1 = ref.length; j < len1; i = ++j) {\n\t\t\t\t\tval = ref[i];\n\t\t\t\t\ttg = val.tg;\n\t\t\t\t\tanm = val.anm;\n\t\t\t\t\tif (anm.isStart()) {\n\t\t\t\t\t\ttg.visible(true);\n\t\t\t\t\t\ts = anm.get(\"scale\");\n\t\t\t\t\t\ttg.scale(s, s, s);\n\t\t\t\t\t\ttg.setTransform();\n\t\t\t\t\t\ttg.alpha(anm.get(\"opacity\"));\n\t\t\t\t\t\tif (anm.isCompleted()) {\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t\ttg.visible(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cnt >= this._effect.length) {\n\t\t\t\t\treturn this._isEffect = false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tonpu2d.prototype._updateOnpu = function() {\n\t\t\tvar ease0, p;\n\t\t\tease0 = 0.2;\n\t\t\tthis._param.onpuTgOffsetX += (0 - this._param.onpuTgOffsetX) * ease0;\n\t\t\tthis._param.onpuTgOffsetY += (0 - this._param.onpuTgOffsetY) * ease0;\n\t\t\tp = 0.4;\n\t\t\tthis._param.onpuVX += (this._param.onpuTgOffsetX - this._param.onpuOffsetX) * p;\n\t\t\tthis._param.onpuVY += (this._param.onpuTgOffsetY - this._param.onpuOffsetY) * p;\n\t\t\tthis._param.onpuOffsetX += (this._param.onpuVX *= p);\n\t\t\treturn this._param.onpuOffsetY += (this._param.onpuVY *= p);\n\t\t};\n\n\t\tonpu2d.prototype.setBasePos = function(x, y, scale) {\n\t\t\tthis._param.baseX = x;\n\t\t\tthis._param.baseY = y;\n\t\t\treturn this._param.baseScale = scale;\n\t\t};\n\n\t\tonpu2d.prototype._eCompleteOnpu = function(w, h) {\n\t\t\tthis._onpuImg.xy(~~(-this._onpuImg.width() * 0.5), ~~(-this._onpuImg.height() * 0.5));\n\t\t\tif (!this._isSmt) {\n\t\t\t\tthis._onpuImg.elm().bind(\"mouseover\", this._startEffect);\n\t\t\t}\n\t\t\treturn this._parent.resize(w, h);\n\t\t};\n\n\t\tonpu2d.prototype._setTransform = function() {\n\t\t\tvar onpuX, onpuY, rot, scale, x, y;\n\t\t\tx = this._param.baseX;\n\t\t\ty = this._param.baseY;\n\t\t\tif (this._anm.isCompleted()) {\n\t\t\t\trot = 0;\n\t\t\t\tscale = this._param.baseScale;\n\t\t\t} else {\n\t\t\t\trot = this._anm.get(\"rot\");\n\t\t\t\tscale = this._anm.get(\"scale\");\n\t\t\t}\n\t\t\tthis.translate(x, y);\n\t\t\tthis.rotate(0, 0, rot);\n\t\t\tthis.scale(scale, scale);\n\t\t\tthis.setTransform();\n\t\t\tonpuX = this._param.onpuX + this._param.onpuOffsetX;\n\t\t\tonpuY = this._param.onpuY + this._param.onpuOffsetY;\n\t\t\tthis._onpuImg.translate(onpuX, onpuY);\n\t\t\tthis._onpuImg.rotate(0, 0, this._param.onpuRot);\n\t\t\treturn this._onpuImg.setTransform();\n\t\t};\n\n\t\tonpu2d.prototype.getOnpuSize = function() {\n\t\t\treturn {\n\t\t\t\twidth: this._onpuImg.width(),\n\t\t\t\theight: this._onpuImg.height()\n\t\t\t};\n\t\t};\n\n\t\tonpu2d.prototype.show = function() {\n\t\t\tif (this.visible()) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.visible(true);\n\t\t\tthis._anm.set({\n\t\t\t\tscale: {\n\t\t\t\t\tfrom: 0,\n\t\t\t\t\tto: 1\n\t\t\t\t},\n\t\t\t\trot: {\n\t\t\t\t\tfrom: this._u.range(90),\n\t\t\t\t\tto: 0\n\t\t\t\t},\n\t\t\t\tframe: 40,\n\t\t\t\tdelay: 0,\n\t\t\t\tease: \"bounceOut\"\n\t\t\t});\n\t\t\treturn this._anm.start();\n\t\t};\n\n\t\tonpu2d.prototype._isContainMouse = function() {\n\t\t\tvar x, y;\n\t\t\tif (this._onpuImg.width() <= 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tx = this._interaction.mouse().x;\n\t\t\ty = this._interaction.mouse().y;\n\t\t\tif (x >= this._param.baseX - this._onpuImg.width() * 0.5 && x <= this._param.baseX + this._onpuImg.width() * 0.5 && y >= this._param.baseY - this._onpuImg.height() * 0.5 && y <= this._param.baseY + this._onpuImg.height() * 0.5) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\tonpu2d.prototype._makeEffect = function() {\n\t\t\tvar anm, circle, color, i, num, obj, results;\n\t\t\ti = 0;\n\t\t\tnum = 2;\n\t\t\tresults = [];\n\t\t\twhile (i < num) {\n\t\t\t\tcolor = new THREE.Color(root.MY.app.conf.RAINBOW_COLOR[this._key]);\n\t\t\t\tcircle = new root.MY_CLASS.circle2d({\n\t\t\t\t\tcolor: \"#\" + color.getHexString(),\n\t\t\t\t\tkey: this._key,\n\t\t\t\t\tfill: i % 2 === 0\n\t\t\t\t});\n\t\t\t\tthis.addChild(circle);\n\t\t\t\tcircle.visible(false);\n\t\t\t\tanm = new root._LIBS.animation();\n\t\t\t\tobj = {\n\t\t\t\t\ttg: circle,\n\t\t\t\t\tanm: anm\n\t\t\t\t};\n\t\t\t\tthis._effect.push(obj);\n\t\t\t\tresults.push(i++);\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\n\t\tonpu2d.prototype._startEffect = function() {\n\t\t\tvar anm, i, j, len1, oldX, oldY, ref, tg, val, x, y;\n\t\t\tif (this._isHide) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._isSmt && this._isEffect) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._isEffect = true;\n\t\t\tref = this._effect;\n\t\t\tfor (i = j = 0, len1 = ref.length; j < len1; i = ++j) {\n\t\t\t\tval = ref[i];\n\t\t\t\ttg = val.tg;\n\t\t\t\tanm = val.anm;\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tanm.set({\n\t\t\t\t\t\tscale: {\n\t\t\t\t\t\t\tfrom: 0,\n\t\t\t\t\t\t\tto: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\topacity: {\n\t\t\t\t\t\t\tfrom: 0.5,\n\t\t\t\t\t\t\tto: 0\n\t\t\t\t\t\t},\n\t\t\t\t\t\tframe: 30,\n\t\t\t\t\t\tdelay: 0,\n\t\t\t\t\t\tease: \"easeOutExpo\"\n\t\t\t\t\t});\n\t\t\t\t\tanm.start();\n\t\t\t\t} else {\n\t\t\t\t\tanm.set({\n\t\t\t\t\t\tscale: {\n\t\t\t\t\t\t\tfrom: 0.25,\n\t\t\t\t\t\t\tto: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\topacity: {\n\t\t\t\t\t\t\tfrom: 1,\n\t\t\t\t\t\t\tto: 0\n\t\t\t\t\t\t},\n\t\t\t\t\t\tframe: 30,\n\t\t\t\t\t\tdelay: 0,\n\t\t\t\t\t\tease: \"easeInOutExpo\"\n\t\t\t\t\t});\n\t\t\t\t\tanm.start();\n\t\t\t\t}\n\t\t\t}\n\t\t\tx = this._interaction.mouse().x;\n\t\t\ty = this._interaction.mouse().y;\n\t\t\toldX = this._interaction.mouse().xOld;\n\t\t\toldY = this._interaction.mouse().yOld;\n\t\t\tthis._param.onpuTgOffsetX = (x - oldX) * 1;\n\t\t\treturn this._param.onpuTgOffsetY = (y - oldY) * 1;\n\t\t};\n\n\t\tonpu2d.prototype.hide = function() {\n\t\t\treturn this._isHide = true;\n\t\t};\n\n\t\treturn onpu2d;\n\n\t}"],"file":"about/my_class/onpu2d.js","sourceRoot":"/source/"}