{"version":3,"names":[],"mappings":"","sources":["about/my_class/top_ground.js"],"sourcesContent":["export default function(superClass) {\n\t\textend(topGround, superClass);\n\n\t\tfunction topGround(stageId) {\n\t\t\tthis._mostDepthObject = bind(this._mostDepthObject, this);\n\t\t\tthis.dispose = bind(this.dispose, this);\n\t\t\tthis.update = bind(this.update, this);\n\t\t\tthis.start = bind(this.start, this);\n\t\t\ttopGround.__super__.constructor.call(this);\n\t\t\tthis._stageId = stageId;\n\t\t\tthis._groundSize = 0;\n\t\t\tthis._stg = [];\n\t\t\tthis._kumo = [];\n\t\t\tthis._fusha = [];\n\t\t}\n\n\t\ttopGround.prototype.start = function() {\n\t\t\tvar fusha, i, kumo, num, obj, orgObj;\n\t\t\ttopGround.__super__.start.call(this);\n\t\t\torgObj = root.MY.gl.data.getStageObj3D(this._stageId, \"stage\");\n\t\t\tthis._groundSize = this.depthFromBBox(orgObj.children[0].geometry.boundingBox);\n\t\t\tthis._groundSize *= this._conf.GROUND_OFFSET.SCALE1;\n\t\t\ti = 0;\n\t\t\tnum = 5;\n\t\t\twhile (i < num) {\n\t\t\t\tobj = orgObj.clone();\n\t\t\t\tthis._container.add(obj);\n\t\t\t\tif (i % 2 !== 0) {\n\t\t\t\t\tobj.scale.x = -1;\n\t\t\t\t} else {\n\t\t\t\t\tobj.scale.x = 1;\n\t\t\t\t}\n\t\t\t\tobj.position.y = this._conf.GROUND_OFFSET.Y;\n\t\t\t\tobj.position.z = -this._groundSize * 0.5 - this._groundSize * i;\n\t\t\t\tthis._stg.push(obj);\n\t\t\t\tkumo = root.MY.gl.data.getCmnObj3D(\"cloud\" + String(this._stageId)).clone();\n\t\t\t\tthis._container.add(kumo);\n\t\t\t\tkumo.position.copy(obj.position);\n\t\t\t\tkumo.position.x = this._conf.CLOUD_POS.BASE_X + this._u.range(this._conf.CLOUD_POS.RANEGE_X);\n\t\t\t\tif (this._isSmt) {\n\t\t\t\t\tkumo.position.y = this._conf.CLOUD_POS.BASE_Y + 20 + this._u.range(this._conf.CLOUD_POS.RANEGE_Y);\n\t\t\t\t} else {\n\t\t\t\t\tkumo.position.y = this._conf.CLOUD_POS.BASE_Y + this._u.range(this._conf.CLOUD_POS.RANEGE_Y);\n\t\t\t\t}\n\t\t\t\tthis._kumo.push(kumo);\n\t\t\t\tfusha = new root.MY_CLASS.fusha();\n\t\t\t\tfusha.start();\n\t\t\t\tthis._container.add(fusha.container());\n\t\t\t\tfusha.show();\n\t\t\t\tfusha.container().position.z = obj.position.z;\n\t\t\t\tfusha.container().scale.x = obj.scale.x;\n\t\t\t\tthis._fusha.push(fusha);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tthis._container.scale.set(this._conf.GROUND_SCALE, this._conf.GROUND_SCALE, this._conf.GROUND_SCALE);\n\t\t\treturn this.update();\n\t\t};\n\n\t\ttopGround.prototype.update = function() {\n\t\t\tvar i, j, k, len1, len2, len3, mostObj, n, ref, ref1, ref2, results, val;\n\t\t\ttopGround.__super__.update.call(this);\n\t\t\tif (this._container.visible) {\n\t\t\t\tref = this._kumo;\n\t\t\t\tfor (i = j = 0, len1 = ref.length; j < len1; i = ++j) {\n\t\t\t\t\tval = ref[i];\n\t\t\t\t\tval.position.z += this._conf.TOP_MOVE_SPEED;\n\t\t\t\t}\n\t\t\t\tref1 = this._fusha;\n\t\t\t\tfor (i = k = 0, len2 = ref1.length; k < len2; i = ++k) {\n\t\t\t\t\tval = ref1[i];\n\t\t\t\t\tval.container().position.z += this._conf.TOP_MOVE_SPEED;\n\t\t\t\t}\n\t\t\t\tref2 = this._stg;\n\t\t\t\tresults = [];\n\t\t\t\tfor (i = n = 0, len3 = ref2.length; n < len3; i = ++n) {\n\t\t\t\t\tval = ref2[i];\n\t\t\t\t\tval.position.z += this._conf.TOP_MOVE_SPEED;\n\t\t\t\t\tif (val.position.z > 100) {\n\t\t\t\t\t\tmostObj = this._mostDepthObject();\n\t\t\t\t\t\tval.position.z = mostObj.position.z - this._groundSize * 0.5 - this._groundSize * 0.5;\n\t\t\t\t\t\tthis._kumo[i].position.z = val.position.z;\n\t\t\t\t\t\tthis._fusha[i].container().position.z = val.position.z;\n\t\t\t\t\t\tif (mostObj.scale.x === 1) {\n\t\t\t\t\t\t\tval.scale.x = -1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tval.scale.x = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresults.push(this._fusha[i].container().scale.x = val.scale.x);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresults.push(void 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn results;\n\t\t\t}\n\t\t};\n\n\t\ttopGround.prototype.dispose = function() {\n\t\t\tvar i, j, k, len1, len2, len3, n, ref, ref1, ref2, val;\n\t\t\tif (this._kumo != null) {\n\t\t\t\tref = this._kumo;\n\t\t\t\tfor (i = j = 0, len1 = ref.length; j < len1; i = ++j) {\n\t\t\t\t\tval = ref[i];\n\t\t\t\t\tif (val != null) {\n\t\t\t\t\t\tthis._container.remove(val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._kumo = null;\n\t\t\t}\n\t\t\tif (this._stg != null) {\n\t\t\t\tref1 = this._stg;\n\t\t\t\tfor (i = k = 0, len2 = ref1.length; k < len2; i = ++k) {\n\t\t\t\t\tval = ref1[i];\n\t\t\t\t\tif (val != null) {\n\t\t\t\t\t\tthis._container.remove(val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._stg = null;\n\t\t\t}\n\t\t\tif (this._fusha != null) {\n\t\t\t\tref2 = this._fusha;\n\t\t\t\tfor (i = n = 0, len3 = ref2.length; n < len3; i = ++n) {\n\t\t\t\t\tval = ref2[i];\n\t\t\t\t\tif (val != null) {\n\t\t\t\t\t\tthis._container.remove(val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._fusha = null;\n\t\t\t}\n\t\t\treturn topGround.__super__.dispose.call(this);\n\t\t};\n\n\t\ttopGround.prototype._mostDepthObject = function() {\n\t\t\tvar i, j, key, len1, ref, val, z;\n\t\t\tkey = 0;\n\t\t\tz = this._stg[0].position.z;\n\t\t\tref = this._stg;\n\t\t\tfor (i = j = 0, len1 = ref.length; j < len1; i = ++j) {\n\t\t\t\tval = ref[i];\n\t\t\t\tif (val.position.z < z) {\n\t\t\t\t\tz = val.position.z;\n\t\t\t\t\tkey = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this._stg[key];\n\t\t};\n\n\t\treturn topGround;\n\n\t}"],"file":"about/my_class/top_ground.js","sourceRoot":"/source/"}