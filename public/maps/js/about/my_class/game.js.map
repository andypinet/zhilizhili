{"version":3,"names":[],"mappings":"","sources":["about/my_class/game.js"],"sourcesContent":["export default function() {\n\t\tfunction game() {\n\t\t\tthis.isUpdatePoint = bind(this.isUpdatePoint, this);\n\t\t\tthis.clearType = bind(this.clearType, this);\n\t\t\tthis.gameLevel = bind(this.gameLevel, this);\n\t\t\tthis.life = bind(this.life, this);\n\t\t\tthis.point = bind(this.point, this);\n\t\t\tthis.endGame = bind(this.endGame, this);\n\t\t\tthis.resumeGame = bind(this.resumeGame, this);\n\t\t\tthis.waitGame = bind(this.waitGame, this);\n\t\t\tthis.resetGame = bind(this.resetGame, this);\n\t\t\tthis.startGame = bind(this.startGame, this);\n\t\t\tthis.isPlaying = bind(this.isPlaying, this);\n\t\t\tthis.upLife = bind(this.upLife, this);\n\t\t\tthis._updateGame = bind(this._updateGame, this);\n\t\t\tthis.nextGameId = bind(this.nextGameId, this);\n\t\t\tthis.gameId = bind(this.gameId, this);\n\t\t\tthis.nextStageId = bind(this.nextStageId, this);\n\t\t\tthis.stageId = bind(this.stageId, this);\n\t\t\tthis.goNextStage = bind(this.goNextStage, this);\n\t\t\tthis.clearStageNum = bind(this.clearStageNum, this);\n\t\t\tthis.update = bind(this.update, this);\n\t\t\tthis.start = bind(this.start, this);\n\t\t\tthis._stageId = 0;\n\t\t\tthis._gameId = 0;\n\t\t\tthis._ui;\n\t\t\tthis._point = 0;\n\t\t\tthis._life = 1;\n\t\t\tthis._delayCall;\n\t\t\tthis._isPlaying = false;\n\t\t\tthis._isUpdateLife = true;\n\t\t\tthis._isUpdatePoint = true;\n\t\t\tthis._gameLevel;\n\t\t\tthis._conf = root.MY.app.conf;\n\t\t\tthis._parameter = root.MY.gl.parameter;\n\t\t\tthis.onGameOver;\n\t\t}\n\n\t\tgame.prototype.start = function() {\n\t\t\tthis._delayCall = new root.MY_CLASS.delayCall();\n\t\t\tthis._delayCall.start();\n\t\t\tthis._ui = root.MY.gl.ui;\n\t\t\tthis._gameLevel = new root.MY_CLASS.gameLevel();\n\t\t\tthis._gameLevel.start();\n\t\t\tthis._parameter.registGameParam(this._gameLevel);\n\t\t\treturn root.MY.myfw.addUpdate(this.update);\n\t\t};\n\n\t\tgame.prototype.update = function() {\n\t\t\tif (this._isPlaying) {\n\t\t\t\treturn this._updateGame();\n\t\t\t}\n\t\t};\n\n\t\tgame.prototype.clearStageNum = function() {\n\t\t\treturn (this._gameId * root.MY.app.conf.STAGE_NUM) + this._stageId;\n\t\t};\n\n\t\tgame.prototype.goNextStage = function() {\n\t\t\tthis._stageId++;\n\t\t\tif (this._stageId >= root.MY.app.conf.STAGE_NUM) {\n\t\t\t\tthis._stageId = 0;\n\t\t\t\tthis._gameId++;\n\t\t\t}\n\t\t\treturn this._gameLevel.levelUp(this.clearStageNum());\n\t\t};\n\n\t\tgame.prototype.stageId = function() {\n\t\t\treturn this._conf.STAGE_ORDER[this._stageId];\n\t\t};\n\n\t\tgame.prototype.nextStageId = function() {\n\t\t\tvar next;\n\t\t\tnext = this._stageId + 1;\n\t\t\tif (next >= root.MY.app.conf.STAGE_NUM) {\n\t\t\t\tnext = 0;\n\t\t\t}\n\t\t\treturn this._conf.STAGE_ORDER[next];\n\t\t};\n\n\t\tgame.prototype.gameId = function() {\n\t\t\treturn this._gameId;\n\t\t};\n\n\t\tgame.prototype.nextGameId = function() {\n\t\t\tif (this._stageId === root.MY.app.conf.STAGE_NUM - 1) {\n\t\t\t\treturn this._gameId + 1;\n\t\t\t} else {\n\t\t\t\treturn this._gameId;\n\t\t\t}\n\t\t};\n\n\t\tgame.prototype._updateGame = function() {\n\t\t\tvar addPoint, deadSpeed;\n\t\t\tif (this._isUpdatePoint) {\n\t\t\t\taddPoint = 0.1;\n\t\t\t\tthis._point = Math.min(this._point += addPoint, this._conf.MAX_AYAKM);\n\t\t\t\tthis._ui.point().setPoint(~~this._point);\n\t\t\t}\n\t\t\tif (this._isUpdateLife) {\n\t\t\t\tdeadSpeed = this._parameter.get(\"lifeSpd\") / 10000;\n\t\t\t\tthis._life = Math.max(0, this._life -= deadSpeed);\n\t\t\t}\n\t\t\tthis._ui.life().setLife(this._life);\n\t\t\tif (this._life <= 0) {\n\t\t\t\treturn this.endGame();\n\t\t\t}\n\t\t};\n\n\t\tgame.prototype.upLife = function(rank, combo) {\n\t\t\tvar up;\n\t\t\tup = [this._parameter.get(\"kaihuku0\"), this._parameter.get(\"kaihuku1\"), this._parameter.get(\"kaihuku2\")][rank];\n\t\t\tif (combo > 1) {\n\t\t\t\tup += up * (combo * this._parameter.get(\"combo\"));\n\t\t\t\tif (combo >= this._conf.MAX_COMBO - 1) {\n\t\t\t\t\tup = 100;\n\t\t\t\t\tthis._isUpdateLife = false;\n\t\t\t\t\tthis._delayCall.onComplete = (function(_this) {\n\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\treturn _this._isUpdateLife = true;\n\t\t\t\t\t\t};\n\t\t\t\t\t})(this);\n\t\t\t\t\tthis._delayCall.watchStart(60 * 2);\n\t\t\t\t}\n\t\t\t}\n\t\t\tup *= 0.01;\n\t\t\treturn this._life = Math.min(this._life += up, 1);\n\t\t};\n\n\t\tgame.prototype.isPlaying = function() {\n\t\t\treturn this._isPlaying;\n\t\t};\n\n\t\tgame.prototype.startGame = function() {\n\t\t\treturn this._isPlaying = true;\n\t\t};\n\n\t\tgame.prototype.resetGame = function() {\n\t\t\tthis._isPlaying = false;\n\t\t\tthis._point = 0;\n\t\t\tthis._life = 1;\n\t\t\tthis._stageId = 0;\n\t\t\tthis._gameId = 0;\n\t\t\treturn this._gameLevel.reset();\n\t\t};\n\n\t\tgame.prototype.waitGame = function() {\n\t\t\treturn this._isPlaying = false;\n\t\t};\n\n\t\tgame.prototype.resumeGame = function() {\n\t\t\tthis._isPlaying = true;\n\t\t\tthis._isUpdateLife = false;\n\t\t\tthis._delayCall.onComplete = (function(_this) {\n\t\t\t\treturn function() {\n\t\t\t\t\treturn _this._isUpdateLife = true;\n\t\t\t\t};\n\t\t\t})(this);\n\t\t\treturn this._delayCall.watchStart(60 * 2);\n\t\t};\n\n\t\tgame.prototype.endGame = function() {\n\t\t\tif (!this._isPlaying) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._isPlaying = false;\n\t\t\tif (typeof localStorage !== \"undefined\" && localStorage !== null) {\n\t\t\t\tif ((localStorage.aykm != null) && localStorage.aykm < this.point()) {\n\t\t\t\t\tlocalStorage.aykm = this.point();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.onGameOver != null) {\n\t\t\t\treturn this.onGameOver();\n\t\t\t}\n\t\t};\n\n\t\tgame.prototype.point = function() {\n\t\t\treturn ~~this._point;\n\t\t};\n\n\t\tgame.prototype.life = function() {\n\t\t\treturn this._life;\n\t\t};\n\n\t\tgame.prototype.gameLevel = function() {\n\t\t\treturn this._gameLevel;\n\t\t};\n\n\t\tgame.prototype.clearType = function() {\n\t\t\tif (this._gameId > 0) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t};\n\n\t\tgame.prototype.isUpdatePoint = function(bool) {\n\t\t\treturn this._isUpdatePoint = bool;\n\t\t};\n\n\t\treturn game;\n\n\t}"],"file":"about/my_class/game.js","sourceRoot":"/source/"}